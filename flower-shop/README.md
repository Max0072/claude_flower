# Флора - Онлайн-магазин цветов

## О проекте
Флора - современный онлайн-магазин цветов и букетов с полным функционалом для заказа и доставки.

## Начало работы

### Быстрый запуск с Docker
Для быстрого запуска всего проекта в контейнерах:

```bash
# Запуск всего проекта в Docker-контейнерах
./infrastructure/deploy.sh

# Проект будет доступен на:
# - Frontend: http://localhost:3000
# - Backend API: http://localhost:5000/api/v1
# - MongoDB: mongodb://localhost:27017/flora
```

### Ручная настройка среды
```bash
# Копирование файла переменных окружения
cp .env.example .env
# Отредактируйте .env файл с вашими настройками
```

### Установка и запуск фронтенда
```bash
cd frontend
npm install
npm run dev
```

### Установка и запуск бэкенда
```bash
cd backend
npm install
npm run dev
```

## Технологический стек
- Frontend: React, Redux, SCSS
- Backend: Node.js, Express
- База данных: MongoDB с Mongoose
- Кэширование: Redis
- Интеграции: Stripe, PayPal, Email, SMS
- Инфраструктура: Docker, Prometheus, Grafana, Nginx, GitHub Actions

## Структура проекта

```
/flower-shop
  /frontend          # React приложение
    /src
      /components    # UI компоненты
      /pages         # Страницы приложения
      /redux         # Управление состоянием
      /styles        # SCSS стили
      /utils         # Вспомогательные функции
    Dockerfile       # Docker-конфигурация для продакшна
    Dockerfile.dev   # Docker-конфигурация для разработки
  /backend           # Node.js/Express API
    /src
      /controllers   # Обработчики запросов
      /models        # Схемы данных
      /routes        # API маршруты
      /services      # Бизнес-логика
      /utils         # Вспомогательные функции
      /integrations  # Интеграции с внешними сервисами
    Dockerfile       # Docker-конфигурация для продакшна
    Dockerfile.dev   # Docker-конфигурация для разработки
    .env.example     # Пример файла с переменными окружения
  /admin             # Админ-панель (React)
  /database          # Модели и конфигурация БД
  /infrastructure    # DevOps инфраструктура
    docker-compose.yml       # Основная конфигурация Docker Compose
    docker-compose.dev.yml   # Конфигурация для разработки
    docker-compose.prod.yml  # Конфигурация для продакшн-среды
    deploy.sh                # Скрипт быстрого деплоя
    quick-cleanup.sh         # Скрипт очистки контейнеров
    /nginx                   # Nginx конфигурация
    /monitoring              # Конфигурация Prometheus и Grafana
  /docs              # Документация
  /tasks             # Задачи для разработчиков
  /.github           # GitHub Actions для CI/CD
```

## База данных

Модуль базы данных содержит MongoDB схемы и конфигурацию с использованием Mongoose:

- Схема продуктов с поддержкой категорий, атрибутов и цен
- Схема пользователей с аутентификацией, адресами и предпочтениями
- Схема заказов с товарными позициями, доставкой и оплатой
- Схема отзывов с рейтингами, комментариями и модерацией
- Схема категорий с иерархической структурой
- Схема купонов с правилами скидок и валидацией

Ключевые особенности:
- Оптимизированное индексирование для частых запросов
- Правила валидации для целостности данных
- Виртуальные свойства для производных данных
- Пре/пост хуки для дополнительного функционала

## Интеграции

Модуль интеграций содержит подключения к внешним сервисам:

### Платежные интеграции
- Stripe для обработки кредитных карт
- PayPal для альтернативных методов оплаты

### Интеграции с доставкой
- Расчет стоимости доставки
- Отслеживание и обновления статуса доставки

### Сервисы уведомлений
- Email уведомления через SMTP
- SMS уведомления для обновлений заказов

## Оптимизация производительности

Приложение включает несколько функций оптимизации производительности:

### Кэширование
- Кэширование на базе Redis для запросов к БД
- Middleware для кэширования запросов Mongoose
- Кэширование API-ответов
- Кэширование в памяти для частых операций

### Оптимизация базы данных
- Оптимизированные индексы MongoDB
- Оптимизация запросов для типичных паттернов
- Денормализация данных где целесообразно

## Безопасность данных

Проект реализует несколько мер безопасности:

- Хеширование паролей с использованием bcrypt
- Аутентификация на основе JWT
- Контроль доступа на основе ролей
- Валидация и санитизация входных данных
- Принудительное HTTPS
- Ограничение запросов
- Защита CORS

## Резервное копирование и восстановление

Приложение включает комплексный функционал резервного копирования:

- Автоматические резервные копии базы данных
- Планирование резервного копирования
- Политики ротации и хранения резервных копий
- Функциональность восстановления в один клик

### Управление резервными копиями

- Создать резервную копию: `npm run backup`
- Список резервных копий: `npm run backup:list`
- Восстановить из резервной копии: `npm run backup:restore`

## DevOps и инфраструктура

Проект настроен с использованием современных DevOps-практик:

### Контейнеризация
- Docker-контейнеры для всех компонентов (фронтенд, бэкенд, БД)
- Оптимизированные Docker-образы с многоступенчатой сборкой
- Docker Compose для оркестрации всех сервисов

### CI/CD
- GitHub Actions для автоматической интеграции и доставки
- Автоматическое тестирование при пуш-событиях
- Деплой с проверками и подтверждениями для продакшн

### Мониторинг
- Prometheus для сбора метрик
- Grafana для визуализации показателей
- Предустановленные дашборды для отслеживания производительности

### Безопасность инфраструктуры
- Nginx в качестве обратного прокси с настройками безопасности
- Защищенные контейнеры с минимальными привилегиями
- Защита от типичных веб-уязвимостей

### Среды запуска
- Настройки для локальной разработки
- Конфигурация тестовой (staging) среды
- Настройки продакшн-окружения

### Система логирования
- Централизованный сбор логов
- Структурированные логи для простого анализа
- Алерты на основе логов

## Разработка
Следуйте инструкциям в файлах задач в директории /tasks. Для быстрого старта работы с проектом используйте скрипт `./infrastructure/deploy.sh`.